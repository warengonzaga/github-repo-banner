<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GitHub Repo Banner Generator</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif;
      background: #0d1117;
      color: #c9d1d9;
      min-height: 100vh;
      padding: 2rem 1rem;
    }

    .layout {
      max-width: 1280px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: 1fr 296px;
      gap: 2rem;
    }

    @media (max-width: 1012px) {
      .layout {
        grid-template-columns: 1fr;
      }
      .sidebar {
        position: static;
      }
    }

    .main-content {
      min-width: 0;
    }

    .readme-container {
      border: 1px solid #30363d;
      border-radius: 6px;
      overflow: hidden;
    }

    .article-title-container {
      padding: 1.25rem 2rem 0.75rem 2rem;
    }

    .article-title {
      font-size: 2rem;
      font-weight: 600;
      color: #c9d1d9;
      margin: 0;
      padding-bottom: 0.35rem;
      border-bottom: 1px solid #21262d;
    }

    .nav-tabs {
      display: flex;
      border-bottom: 1px solid #21262d;
      margin-bottom: 0;
      gap: 0;
      background: transparent;
      padding: 0.5rem 1rem 0 1rem;
    }

    .nav-tab {
      padding: 0.5rem 0.75rem;
      font-size: 0.875rem;
      font-weight: 400;
      line-height: 1.5;
      color: #7d8590;
      text-decoration: none;
      border: none;
      border-bottom: 2px solid transparent;
      background: transparent;
      cursor: pointer;
      transition: all 0.15s;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      position: relative;
      margin-bottom: -1px;
    }

    .nav-tab svg {
      width: 16px;
      height: 16px;
      fill: currentColor;
      flex-shrink: 0;
    }

    .nav-tab:hover {
      color: #c9d1d9;
      border-bottom-color: #484f58;
    }

    .nav-tab.active {
      color: #c9d1d9;
      border-bottom-color: #f78166;
    }

    .content-container {
      background: #0d1117;
    }

    h1 {
      font-size: 2rem;
      font-weight: 600;
      color: #c9d1d9;
      margin-bottom: 1rem;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid #21262d;
    }

    .preview {
      width: 100%;
      overflow: hidden;
      padding: 0 2rem;
      box-sizing: border-box;
    }

    .preview img {
      width: 100%;
      display: block;
    }

    .content-section {
      padding: 1rem 2rem;
    }

    .content-section:first-child {
      padding-top: 0.75rem;
      padding-bottom: 0rem;
    }

    .content-section:last-child {
      padding-top: 0.5rem;
      padding-bottom: 1.5rem;
    }

    .content-section h2 {
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 0.75rem;
      color: #c9d1d9;
      padding-bottom: 0.375rem;
      border-bottom: 1px solid #21262d;
    }

    .settings-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 0.875rem 1rem;
      margin-bottom: 1.25rem;
    }

    @media (max-width: 768px) {
      .settings-grid {
        grid-template-columns: 1fr;
      }
    }

    .settings-grid .form-group {
      margin-bottom: 0;
    }

    .settings-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
    }

    @media (max-width: 768px) {
      .settings-grid {
        grid-template-columns: 1fr;
      }
    }

    .settings-grid .form-group {
      margin-bottom: 0;
    }

    .form-group {
      margin-bottom: 0.625rem;
    }

    .form-group:last-child {
      margin-bottom: 0;
    }

    label {
      display: block;
      font-size: 0.875rem;
      font-weight: 600;
      color: #c9d1d9;
      margin-bottom: 0.5rem;
    }

    input[type="text"] {
      width: 100%;
      background: #0d1117;
      border: 1px solid #30363d;
      border-radius: 6px;
      padding: 0.5rem 0.75rem;
      color: #c9d1d9;
      font-size: 0.875rem;
      outline: none;
      transition: border-color 0.15s;
    }

    input[type="text"]:focus {
      border-color: #1f6feb;
      box-shadow: 0 0 0 3px rgba(31, 111, 235, 0.1);
    }

    input[type="text"].limit-exceeded {
      border-color: #f85149;
      animation: glow-red 1.5s ease-in-out infinite;
    }

    input[type="text"].will-truncate {
      border-color: #d29922;
      animation: glow-orange 1.5s ease-in-out infinite;
    }

    input[type="text"].limit-exceeded:focus {
      border-color: #f85149;
      box-shadow: 0 0 0 3px rgba(248, 81, 73, 0.2);
    }

    input[type="text"].will-truncate:focus {
      border-color: #d29922;
      box-shadow: 0 0 0 3px rgba(210, 153, 34, 0.2);
    }

    @keyframes glow-red {
      0%, 100% {
        box-shadow: 0 0 0 0 rgba(248, 81, 73, 0);
      }
      50% {
        box-shadow: 0 0 8px 2px rgba(248, 81, 73, 0.4);
      }
    }

    @keyframes glow-orange {
      0%, 100% {
        box-shadow: 0 0 0 0 rgba(210, 153, 34, 0);
      }
      50% {
        box-shadow: 0 0 8px 2px rgba(210, 153, 34, 0.4);
      }
    }

    .char-counter {
      font-size: 0.75rem;
      color: #7d8590;
      margin-top: 0.375rem;
      display: flex;
      gap: 0;
      align-items: center;
    }

    .char-counter-separator {
      margin: 0 0.5rem;
      color: #484f58;
      font-weight: 400;
    }

    .char-counter-part {
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }

    .char-counter-part.exceeded {
      color: #f85149;
      font-weight: 600;
    }

    .char-counter-part.warning {
      color: #d29922;
      font-weight: 600;
    }

    .char-counter-part.truncated {
      color: #d29922;
      font-weight: 600;
    }

    .char-counter-info {
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      cursor: help;
      position: relative;
      z-index: 100;
    }

    .char-counter-info-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: #30363d;
      color: #7d8590;
      font-size: 10px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .char-counter-info-icon:hover {
      background: #484f58;
      color: #c9d1d9;
    }

    .char-counter-tooltip {
      position: absolute;
      bottom: calc(100% + 12px);
      left: 50%;
      transform: translateX(-50%);
      background: #1c2128;
      border: 1px solid #30363d;
      border-radius: 6px;
      padding: 10px 14px;
      font-size: 0.75rem;
      white-space: pre-line;
      width: max-content;
      max-width: 600px;
      z-index: 10000;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s;
      line-height: 1.6;
      word-break: break-word;
    }

    .char-counter-tooltip::after {
      content: '';
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      border: 6px solid transparent;
      border-top-color: #30363d;
    }

    .char-counter-info-icon.active + .char-counter-tooltip,
    .char-counter-info:hover .char-counter-tooltip {
      opacity: 1;
      pointer-events: auto;
    }

    .char-counter-part.truncated {
      color: #d29922;
      font-weight: 600;
    }

    .char-counter-part.truncated {
      color: #d29922;
      font-weight: 600;
    }

    .color-row {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .hex-input-group {
      display: flex;
      align-items: center;
      border: 1px solid #30363d;
      border-radius: 6px;
      overflow: hidden;
      transition: border-color 0.15s;
      flex: 1;
    }

    .hex-input-group:focus-within {
      border-color: #1f6feb;
      box-shadow: 0 0 0 3px rgba(31, 111, 235, 0.1);
    }

    .hex-prefix {
      background: #161b22;
      color: #7d8590;
      padding: 0.5rem;
      font-size: 0.875rem;
      font-weight: 600;
      -webkit-user-select: none;
      user-select: none;
      border-right: 1px solid #30363d;
    }

    .hex-input-group input[type="text"] {
      border: none;
      border-radius: 0;
      width: 90px;
      background: #0d1117;
      padding: 0.5rem;
      box-shadow: none !important;
    }

    .color-preview {
      width: 32px;
      height: 32px;
      border-radius: 6px;
      border: 1px solid #30363d;
      flex-shrink: 0;
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
    }

    .color-preview:hover {
      transform: scale(1.1);
      border-color: #58a6ff;
      box-shadow: 0 0 0 3px rgba(88, 166, 255, 0.1);
    }

    .color-preview:active {
      transform: scale(1.05);
    }

    .color-picker-input {
      position: absolute;
      opacity: 0;
      width: 0;
      height: 0;
      pointer-events: none;
    }

    .input-with-info {
      position: relative;
    }

    .input-with-info input[type="text"] {
      padding-right: 2.5rem;
    }

    .info-icon-btn {
      position: absolute;
      right: 0.5rem;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: #7d8590;
      cursor: pointer;
      padding: 0.25rem;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 4px;
      transition: all 0.2s;
    }

    .info-icon-btn:hover {
      color: #58a6ff;
      background: rgba(88, 166, 255, 0.1);
    }

    .info-icon-btn svg {
      width: 16px;
      height: 16px;
      fill: currentColor;
    }

    .info-tooltip {
      position: absolute;
      top: calc(100% + 0.5rem);
      right: 0;
      background: #161b22;
      border: 1px solid #30363d;
      border-radius: 6px;
      padding: 1rem;
      width: 320px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
      z-index: 1000;
      display: none;
    }

    .info-tooltip.show {
      display: block;
      animation: tooltipFadeIn 0.2s ease-out;
    }

    @keyframes tooltipFadeIn {
      from {
        opacity: 0;
        transform: translateY(-4px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .info-tooltip h4 {
      font-size: 0.875rem;
      font-weight: 600;
      color: #c9d1d9;
      margin: 0 0 0.75rem 0;
    }

    .info-tooltip p {
      font-size: 0.75rem;
      color: #7d8590;
      margin: 0 0 0.75rem 0;
      line-height: 1.5;
    }

    .info-tooltip ul {
      list-style: none;
      padding: 0;
      margin: 0 0 0.75rem 0;
    }

    .info-tooltip li {
      font-size: 0.75rem;
      color: #7d8590;
      padding: 0.25rem 0;
      line-height: 1.5;
    }

    .info-tooltip li strong {
      color: #c9d1d9;
      font-weight: 600;
    }

    .info-tooltip a {
      color: #58a6ff;
      text-decoration: none;
    }

    .info-tooltip a:hover {
      text-decoration: underline;
    }

    .info-tooltip code {
      background: #0d1117;
      border: 1px solid #30363d;
      border-radius: 3px;
      padding: 0.125rem 0.375rem;
      font-family: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Consolas, 'Liberation Mono', monospace;
      font-size: 0.75rem;
      color: #c9d1d9;
    }

    .bg-options {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 0.5rem;
    }

    .bg-option {
      position: relative;
    }

    .preset-btn {
      width: 100%;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem;
      border-radius: 6px;
      border: 1px solid #30363d;
      cursor: pointer;
      font-size: 0.75rem;
      font-weight: 500;
      transition: all 0.15s;
      background: #0d1117;
      color: #c9d1d9;
    }

    .preset-btn:hover {
      border-color: #58a6ff;
      background: rgba(31, 111, 235, 0.05);
    }

    .preset-btn.active {
      border-color: #1f6feb;
      background: rgba(31, 111, 235, 0.1);
    }

    .new-badge {
      position: absolute;
      top: -6px;
      right: -6px;
      background: #238636;
      color: #fff;
      font-size: 0.625rem;
      font-weight: 600;
      padding: 0.125rem 0.375rem;
      border-radius: 12px;
      text-transform: uppercase;
      z-index: 1;
      pointer-events: none;
      opacity: 1;
      transition: opacity 0.3s ease-out;
    }

    .new-badge.fade-out {
      opacity: 0;
    }

    .settings-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 0.75rem;
      padding-bottom: 0.375rem;
      border-bottom: 1px solid #21262d;
    }

    .settings-header h2 {
      font-size: 1.5rem;
      font-weight: 600;
      color: #c9d1d9;
      margin: 0;
      padding: 0;
      border: none;
    }

    .reset-btn {
      display: flex;
      align-items: center;
      gap: 0.375rem;
      padding: 0.375rem 0.75rem;
      background: #0d1117;
      color: #c9d1d9;
      border: 1px solid #30363d;
      border-radius: 6px;
      font-size: 0.75rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s;
    }

    .reset-btn:hover {
      background: rgba(177, 186, 196, 0.12);
      border-color: #58a6ff;
    }

    .reset-btn svg {
      width: 14px;
      height: 14px;
      fill: currentColor;
    }

    .position-selector {
      margin-top: 1rem;
      display: none;
    }

    .position-selector.visible {
      display: block;
    }

    .position-selector-label {
      font-size: 0.75rem;
      font-weight: 600;
      color: #7d8590;
      margin-bottom: 0.5rem;
      display: block;
    }

    .position-options {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 0.5rem;
    }

    .position-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0.5rem;
      border-radius: 6px;
      border: 1px solid #30363d;
      background: #0d1117;
      color: #c9d1d9;
      font-size: 0.75rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s;
    }

    .position-btn:hover {
      border-color: #58a6ff;
      background: rgba(31, 111, 235, 0.05);
    }

    .position-btn.active {
      border-color: #1f6feb;
      background: rgba(31, 111, 235, 0.1);
    }

    .swatch {
      width: 24px;
      height: 24px;
      border-radius: 4px;
      flex-shrink: 0;
      border: 1px solid #30363d;
    }

    .checkbox-container {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1rem;
      background: #161b22;
      border: 1px solid #30363d;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.15s;
    }

    .checkbox-container:hover {
      background: #1c2128;
      border-color: #484f58;
    }

    .checkbox-container input[type="checkbox"] {
      display: none;
    }

    .checkbox-label {
      flex: 1;
      cursor: pointer;
    }

    .checkbox-label .title {
      font-size: 0.875rem;
      font-weight: 600;
      color: #c9d1d9;
      margin-bottom: 0.25rem;
    }

    .checkbox-label .description {
      font-size: 0.75rem;
      color: #7d8590;
    }

    .toggle-switch {
      position: relative;
      width: 44px;
      height: 24px;
      background: #30363d;
      border-radius: 12px;
      transition: all 0.2s;
      cursor: pointer;
      flex-shrink: 0;
    }

    .toggle-switch::after {
      content: '';
      position: absolute;
      top: 2px;
      left: 2px;
      width: 20px;
      height: 20px;
      background: #7d8590;
      border-radius: 50%;
      transition: all 0.2s;
    }

    .checkbox-container input[type="checkbox"]:checked ~ .toggle-switch {
      background: #1f6feb;
    }

    .checkbox-container input[type="checkbox"]:checked ~ .toggle-switch::after {
      left: 22px;
      background: #ffffff;
    }

    .sponsor-notice {
      padding: 0.75rem 1rem;
      background: rgba(187, 128, 9, 0.1);
      border: 1px solid #9e6a03;
      border-radius: 6px;
      font-size: 0.875rem;
      color: #c9d1d9;
      text-align: center;
      transition: all 0.3s ease;
    }

    .sponsor-notice.thank-you {
      background: rgba(46, 160, 67, 0.1);
      border-color: #2ea043;
    }

    .sponsor-notice a {
      color: #58a6ff;
      text-decoration: none;
      font-weight: 600;
    }

    .sponsor-notice a:hover {
      text-decoration: underline;
    }

    .emoji-explosion {
      position: fixed;
      pointer-events: none;
      font-size: 2rem;
      animation: explode 1s ease-out forwards;
      z-index: 9999;
    }

    @keyframes explode {
      0% {
        transform: translate(0, 0) scale(0);
        opacity: 1;
      }
      50% {
        opacity: 1;
      }
      100% {
        transform: translate(var(--tx), var(--ty)) scale(1);
        opacity: 0;
      }
    }

    @keyframes explodeSad {
      0% {
        transform: translate(0, 0) scale(0);
        opacity: 1;
      }
      30% {
        transform: translate(calc(var(--tx) * 0.3), calc(var(--ty) * 0.3)) scale(1.5);
        opacity: 1;
      }
      60% {
        opacity: 1;
      }
      100% {
        transform: translate(var(--tx), var(--ty)) scale(2);
        opacity: 0;
      }
    }

    .output-container {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .output-container textarea {
      width: 100%;
      height: auto;
      min-height: 40px;
      resize: vertical;
      font-family: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Consolas, 'Liberation Mono', monospace;
      font-size: 0.875rem;
      background: #262C36;
      border: 1px solid #30363d;
      border-radius: 6px;
      padding: 0.75rem;
      color: #c9d1d9;
      outline: none;
      transition: border-color 0.15s;
      line-height: 1.5;
      white-space: pre-wrap;
      word-wrap: break-word;
      overflow-wrap: break-word;
      overflow: hidden;
    }

    .output-container textarea:focus {
      border-color: #1f6feb;
      box-shadow: 0 0 0 3px rgba(31, 111, 235, 0.1);
    }

    .button-row {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    .button-row button {
      flex: 1;
      min-width: fit-content;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .button-row button svg {
      width: 16px;
      height: 16px;
      fill: currentColor;
      flex-shrink: 0;
    }

    button {
      background: #238636;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 0.5rem 1rem;
      font-size: 0.875rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s;
      white-space: nowrap;
    }

    button:hover {
      background: #2ea043;
    }

    button.secondary {
      background: #0d1117;
      color: #c9d1d9;
      border: 1px solid #30363d;
    }

    button.secondary:hover {
      background: rgba(31, 111, 235, 0.05);
      border-color: #58a6ff;
    }

    .copied {
      background: #1f6feb !important;
    }

    .sidebar {
      position: sticky;
      top: 2rem;
      align-self: start;
    }

    .sidebar-section {
      background: #0d1117;
      border: 1px solid #30363d;
      border-radius: 6px;
      padding: 1rem;
      margin-bottom: 1rem;
    }

    .sidebar-section h2 {
      font-size: 0.75rem;
      font-weight: 600;
      color: #7d8590;
      text-transform: uppercase;
      margin-bottom: 1rem;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid #21262d;
    }

    .author-card {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      text-decoration: none;
      color: #c9d1d9;
      transition: background 0.15s;
      padding: 0.5rem;
      margin: -0.5rem;
      border-radius: 6px;
    }

    .author-card:hover {
      background: rgba(177, 186, 196, 0.12);
    }

    .author-avatar {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      border: 1px solid #30363d;
    }

    .author-info {
      flex: 1;
      min-width: 0;
    }

    .author-name {
      font-size: 0.875rem;
      font-weight: 600;
      color: #c9d1d9;
      display: block;
      margin-bottom: 0.125rem;
    }

    .author-username {
      font-size: 0.75rem;
      color: #7d8590;
      display: block;
    }

    .author-tagline {
      font-size: 0.8125rem;
      color: #7d8590;
      text-align: center;
      margin-top: 0.75rem;
      line-height: 1.5;
      font-style: italic;
    }

    .sponsor-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      width: 100%;
      padding: 0.5rem 1rem;
      margin-top: 1rem;
      background: #bf3989;
      color: #fff;
      border: none;
      border-radius: 6px;
      font-size: 0.875rem;
      font-weight: 500;
      text-decoration: none;
      cursor: pointer;
      transition: background 0.15s;
    }

    .sponsor-btn:hover {
      background: #a03377;
    }

    .sponsor-btn svg {
      width: 16px;
      height: 16px;
      fill: currentColor;
    }

    .follow-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      width: 100%;
      padding: 0.5rem 1rem;
      margin-top: 0.5rem;
      background: #000;
      color: #fff;
      border: none;
      border-radius: 6px;
      font-size: 0.875rem;
      font-weight: 500;
      text-decoration: none;
      cursor: pointer;
      transition: background 0.15s;
    }

    .follow-btn:hover {
      background: #333;
    }

    .follow-btn svg {
      width: 16px;
      height: 16px;
      fill: currentColor;
    }

    .contribute-message {
      font-size: 0.75rem;
      color: #7d8590;
      text-align: center;
      margin-top: 0.75rem;
      line-height: 1.5;
    }

    .contribute-links {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .contribute-btn {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      width: 100%;
      padding: 0.5rem 0.75rem;
      background: #0d1117;
      color: #c9d1d9;
      border: 1px solid #30363d;
      border-radius: 6px;
      font-size: 0.875rem;
      font-weight: 500;
      text-decoration: none;
      cursor: pointer;
      transition: all 0.15s;
      text-align: left;
    }

    .contribute-btn:hover {
      background: rgba(177, 186, 196, 0.12);
      border-color: #58a6ff;
    }

    .contribute-btn svg {
      width: 16px;
      height: 16px;
      fill: currentColor;
      flex-shrink: 0;
    }

    .deploy-btn {
      display: block;
      width: 100%;
      text-decoration: none;
      transition: opacity 0.15s;
    }

    .deploy-btn:hover {
      opacity: 0.8;
    }

    .deploy-img {
      width: 100%;
      height: auto;
      display: block;
    }

    .deploy-message {
      font-size: 0.75rem;
      color: #7d8590;
      text-align: center;
      margin-top: 0.75rem;
      line-height: 1.5;
    }

    .version-display {
      font-size: 0.75rem;
      color: #7d8590;
      text-align: center;
      padding: 0.75rem;
    }

    .repo-description {
      padding: 0.75rem 2rem 0rem 2rem;
      font-size: 1rem;
      color: #c9d1d9;
      line-height: 1.5;
    }
  </style>
</head>
<body>
  <div class="layout">
    <main class="main-content">
      <div class="readme-container">
        <div class="nav-tabs">
        <div class="nav-tab active">
          <svg viewBox="0 0 16 16" aria-hidden="true">
            <path d="M0 1.75A.75.75 0 0 1 .75 1h4.253c1.227 0 2.317.59 3 1.501A3.743 3.743 0 0 1 11.006 1h4.245a.75.75 0 0 1 .75.75v10.5a.75.75 0 0 1-.75.75h-4.507a2.25 2.25 0 0 0-1.591.659l-.622.621a.75.75 0 0 1-1.06 0l-.622-.621A2.25 2.25 0 0 0 5.258 13H.75a.75.75 0 0 1-.75-.75Zm7.251 10.324.004-5.073-.002-2.253A2.25 2.25 0 0 0 5.003 2.5H1.5v9h3.757a3.75 3.75 0 0 1 1.994.574ZM8.755 4.75l-.004 7.322a3.752 3.752 0 0 1 1.992-.572H14.5v-9h-3.495a2.25 2.25 0 0 0-2.25 2.25Z"></path>
          </svg>
          README
        </div>
        <div class="nav-tab">
          <svg viewBox="0 0 16 16" aria-hidden="true">
            <path d="m8 14.25.345.666a.75.75 0 0 1-.69 0l-.008-.004-.018-.01a7.152 7.152 0 0 1-.31-.17 22.055 22.055 0 0 1-3.434-2.414C2.045 10.731 0 8.35 0 5.5 0 2.836 2.086 1 4.25 1 5.797 1 7.153 1.802 8 3.02 8.847 1.802 10.203 1 11.75 1 13.914 1 16 2.836 16 5.5c0 2.85-2.045 5.231-3.885 6.818a22.066 22.066 0 0 1-3.744 2.584l-.018.01-.006.003h-.002ZM4.25 2.5c-1.336 0-2.75 1.164-2.75 3 0 2.15 1.58 4.144 3.365 5.682A20.58 20.58 0 0 0 8 13.393a20.58 20.58 0 0 0 3.135-2.211C12.92 9.644 14.5 7.65 14.5 5.5c0-1.836-1.414-3-2.75-3-1.373 0-2.609.986-3.029 2.456a.749.749 0 0 1-1.442 0C6.859 3.486 5.623 2.5 4.25 2.5Z"></path>
          </svg>
          Code of conduct
        </div>
        <div class="nav-tab">
          <svg viewBox="0 0 16 16" aria-hidden="true">
            <path d="M8.75.75V2h.985c.304 0 .603.08.867.231l1.29.736c.038.022.08.033.124.033h2.234a.75.75 0 0 1 0 1.5h-.427l2.111 4.692a.75.75 0 0 1-.154.838l-.53-.53.529.531-.001.002-.002.002-.006.006-.006.005-.01.01-.045.04c-.21.176-.441.327-.686.45C14.556 10.78 13.88 11 13 11a4.498 4.498 0 0 1-2.023-.454 3.544 3.544 0 0 1-.686-.45l-.045-.04-.016-.015-.006-.006-.004-.004v-.001a.75.75 0 0 1-.154-.838L12.178 4.5h-.162c-.305 0-.604-.079-.868-.231l-1.29-.736a.245.245 0 0 0-.124-.033H8.75V13h2.5a.75.75 0 0 1 0 1.5h-6.5a.75.75 0 0 1 0-1.5h2.5V3.5h-.984a.245.245 0 0 0-.124.033l-1.289.737c-.265.15-.564.23-.869.23h-.162l2.112 4.692a.75.75 0 0 1-.154.838l-.53-.53.529.531-.001.002-.002.002-.006.006-.016.015-.045.04c-.21.176-.441.327-.686.45C4.556 10.78 3.88 11 3 11a4.498 4.498 0 0 1-2.023-.454 3.544 3.544 0 0 1-.686-.45l-.045-.04-.016-.015-.006-.006-.004-.004v-.001a.75.75 0 0 1-.154-.838L2.178 4.5H1.75a.75.75 0 0 1 0-1.5h2.234a.249.249 0 0 0 .125-.033l1.288-.737c.265-.15.564-.23.869-.23h.984V.75a.75.75 0 0 1 1.5 0Zm2.945 8.477c.285.135.718.273 1.305.273s1.02-.138 1.305-.273L13 6.327Zm-10 0c.285.135.718.273 1.305.273s1.02-.138 1.305-.273L3 6.327Z"></path>
          </svg>
          MIT license
        </div>
      </div>

      <div class="content-container">
        <div class="article-title-container">
          <h1 class="article-title">GitHub Repo Banner</h1>
        </div>
        
        <div class="preview">
          <img id="preview" alt="Banner preview" />
        </div>

        <div class="repo-description">
          I believe every repository deserves to look beautiful. Your code is art, your projects deserve stunning visuals to match. But design tools steal hours you don't have. So I built a service that generates gorgeous banners through simple URL parameters. Instant, customizable, and no design tools required. Because great projects deserve great presentation.
        </div>

        <div class="content-section">
          <div class="settings-header">
            <h2>Settings</h2>
            <button id="reset-btn" class="reset-btn" title="Reset to defaults">
              <svg viewBox="0 0 16 16" aria-hidden="true">
                <path d="M1.705 8.005a.75.75 0 0 1 .834.656 5.5 5.5 0 0 0 9.592 2.97l-1.204-1.204a.25.25 0 0 1 .177-.427h3.646a.25.25 0 0 1 .25.25v3.646a.25.25 0 0 1-.427.177l-1.38-1.38A7.002 7.002 0 0 1 1.05 8.84a.75.75 0 0 1 .656-.834ZM8 2.5a5.487 5.487 0 0 0-4.131 1.869l1.204 1.204A.25.25 0 0 1 4.896 6H1.25A.25.25 0 0 1 1 5.75V2.104a.25.25 0 0 1 .427-.177l1.38 1.38A7.002 7.002 0 0 1 14.95 7.16a.75.75 0 0 1-1.49.178A5.5 5.5 0 0 0 8 2.5Z"></path>
              </svg>
              Reset
            </button>
          </div>
        
        <div class="settings-grid">
        <div class="form-group">
          <label for="header">Header Text</label>
          <div class="input-with-info">
            <input type="text" id="header" value="![github] Hello World üëã" placeholder="Enter your repository title or project name" />
            <button type="button" class="info-icon-btn" id="header-info-btn" aria-label="Show emoji and icon help">
              <svg viewBox="0 0 16 16" aria-hidden="true">
                <path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path>
              </svg>
            </button>
            <div class="info-tooltip" id="header-info-tooltip">
              <h4>Using Emojis & Icons</h4>
              <p><strong>Emojis:</strong> Copy from <a href="https://emojipedia.org" target="_blank" rel="noopener">Emojipedia</a> and paste</p>
              <ul>
                <li>Example: "Hello World üëã"</li>
              </ul>
              <p><strong>Simple Icons:</strong> Use <code>![icon-name]</code> from <a href="https://simpleicons.org" target="_blank" rel="noopener">Simple Icons</a></p>
              <ul>
                <li>Auto theme: "React ![react] App"</li>
                <li>Light theme: "GitHub ![github](light)"</li>
                <li>Dark theme: "Node ![node](dark)"</li>
              </ul>
            </div>
          </div>
          <div class="char-counter" id="header-counter">
            <span class="char-counter-part" id="header-text-count">Text: 0/50</span>
            <span class="char-counter-separator">|</span>
            <span class="char-counter-part" id="header-icon-count">Icons: none</span>
          </div>
        </div>

        <div class="form-group">
          <label for="header-font-input">Header Font (Google Fonts)</label>
          <div class="input-with-info">
            <input type="text" id="header-font-input" value="Permanent Marker" placeholder="Try Roboto, Poppins, Montserrat..." maxlength="50" />
            <button type="button" class="info-icon-btn" id="header-font-info-btn" aria-label="Show font help">
              <svg viewBox="0 0 16 16" aria-hidden="true">
                <path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path>
              </svg>
            </button>
            <div class="info-tooltip" id="header-font-info-tooltip">
              <h4>Using Google Fonts</h4>
              <p>Browse fonts at <a href="https://fonts.google.com" target="_blank" rel="noopener">Google Fonts</a> and copy the font name exactly as shown.</p>
              <p><strong>Examples:</strong></p>
              <ul>
                <li>Roboto</li>
                <li>Permanent Marker</li>
                <li>Montserrat</li>
                <li>Poppins</li>
              </ul>
              <p style="margin-top: 0.5rem;">Leave empty to use the default font.</p>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label for="subheader">Sub Header Text (optional)</label>
          <div class="input-with-info">
            <input type="text" id="subheader" value="Great projects deserve great repository banners" placeholder="Add a compelling tagline or description" />
            <button type="button" class="info-icon-btn" id="subheader-info-btn" aria-label="Show emoji and icon help">
              <svg viewBox="0 0 16 16" aria-hidden="true">
                <path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path>
              </svg>
            </button>
            <div class="info-tooltip" id="subheader-info-tooltip">
              <h4>Using Emojis & Icons</h4>
              <p><strong>Emojis:</strong> Copy from <a href="https://emojipedia.org" target="_blank" rel="noopener">Emojipedia</a> and paste</p>
              <ul>
                <li>Example: "Made with ‚ù§Ô∏è"</li>
              </ul>
              <p><strong>Simple Icons:</strong> Use <code>![icon-name]</code> from <a href="https://simpleicons.org" target="_blank" rel="noopener">Simple Icons</a></p>
              <ul>
                <li>Auto theme: "Built with ![typescript]"</li>
                <li>Light theme: "Powered by ![vercel](light)"</li>
                <li>Dark theme: "Made by ![github](dark)"</li>
              </ul>
            </div>
          </div>
          <div class="char-counter" id="subheader-counter">
            <span class="char-counter-part" id="subheader-text-count">Text: 0/60</span>
            <span class="char-counter-separator">|</span>
            <span class="char-counter-part" id="subheader-icon-count">Icons: none</span>
          </div>
        </div>

        <div class="form-group" id="subheader-font-group">
          <label for="subheader-font-input">Sub Header Font (Google Fonts)</label>
          <div class="input-with-info">
            <input type="text" id="subheader-font-input" value="Kinewave" placeholder="Try Inter, Open Sans, Lato..." maxlength="50" />
            <button type="button" class="info-icon-btn" id="subheader-font-info-btn" aria-label="Show font help">
              <svg viewBox="0 0 16 16" aria-hidden="true">
                <path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path>
              </svg>
            </button>
            <div class="info-tooltip" id="subheader-font-info-tooltip">
              <h4>Using Google Fonts</h4>
              <p>Browse fonts at <a href="https://fonts.google.com" target="_blank" rel="noopener">Google Fonts</a> and copy the font name exactly as shown.</p>
              <p><strong>Examples:</strong></p>
              <ul>
                <li>Inter</li>
                <li>Open Sans</li>
                <li>Lato</li>
                <li>Kinewave</li>
              </ul>
              <p style="margin-top: 0.5rem;">Leave empty to use the default font.</p>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label for="color-input">Header Text Color</label>
          <div class="color-row">
            <div class="hex-input-group">
              <span class="hex-prefix">#</span>
              <input type="text" id="color-input" value="FFFFFF" placeholder="FFFFFF" maxlength="8" />
            </div>
            <span class="color-preview" id="color-preview" title="Click to open color picker"></span>
            <input type="color" id="color-picker" class="color-picker-input" />
          </div>
        </div>

        <div class="form-group" id="subheader-color-group">
          <label for="subheader-color-input">Sub Header Text Color (optional)</label>
          <div class="color-row">
            <div class="hex-input-group">
              <span class="hex-prefix">#</span>
              <input type="text" id="subheader-color-input" value="" placeholder="FFFFFF" maxlength="8" />
            </div>
            <span class="color-preview" id="subheader-color-preview" title="Click to open color picker"></span>
            <input type="color" id="subheader-color-picker" class="color-picker-input" />
          </div>
        </div>

        <div class="form-group">
          <label for="bg-input">Primary Background Color</label>
          <div class="color-row">
            <div class="hex-input-group">
              <span class="hex-prefix">#</span>
              <input type="text" id="bg-input" value="1A1A1A" placeholder="000000" maxlength="8" />
            </div>
            <span class="color-preview" id="bg-preview" title="Click to open color picker"></span>
            <input type="color" id="bg-picker" class="color-picker-input" />
          </div>
        </div>

        <div class="form-group">
          <label for="bg-input-2">Secondary Background Color</label>
          <div class="color-row">
            <div class="hex-input-group">
              <span class="hex-prefix">#</span>
              <input type="text" id="bg-input-2" value="4A4A4A" placeholder="FFFFFF" maxlength="8" />
            </div>
            <span class="color-preview" id="bg-preview-2" title="Click to open color picker"></span>
            <input type="color" id="bg-picker-2" class="color-picker-input" />
          </div>
          <p style="font-size: 0.75rem; color: #7d8590; margin-top: 0.5rem;">
            Leave empty for solid background color.
          </p>
        </div>
        </div>

        <div class="form-group">
          <label>Color Presets (click to apply)</label>
          <div class="bg-options">
            <div class="bg-option">
              <button type="button" class="preset-btn" data-bg="1A1A1A-4A4A4A" data-color="FFFFFF" data-gradient="true">
                <span class="swatch" style="background: linear-gradient(90deg, #1a1a1a, #4a4a4a);"></span>
                Midnight
              </button>
            </div>
            <div class="bg-option">
              <button type="button" class="preset-btn" data-bg="EC4899-3B82F6" data-color="FFFFFF" data-gradient="true">
                <span class="swatch" style="background: linear-gradient(90deg, #ec4899, #3b82f6);"></span>
                Vibe
              </button>
            </div>
            <div class="bg-option">
              <button type="button" class="preset-btn" data-bg="14B8A6-06B6D4" data-color="FFFFFF" data-gradient="true">
            <span class="swatch" style="background: linear-gradient(90deg, #14b8a6, #06b6d4);"></span>
            Ocean
          </button>
        </div>
        <div class="bg-option">
          <span class="new-badge">New</span>
          <button type="button" class="preset-btn" data-bg="431586-9231A8" data-color="FFFFFF" data-gradient="true">
            <span class="swatch" style="background: linear-gradient(90deg, #431586, #9231A8);"></span>
            Railway
          </button>
        </div>
        <div class="bg-option">
          <span class="new-badge">New</span>
          <button type="button" class="preset-btn" data-bg="F38020-FBAB41" data-color="FFFFFF" data-gradient="true">
            <span class="swatch" style="background: linear-gradient(90deg, #F38020, #FBAB41);"></span>
            Cloudflare
          </button>
        </div>
        <div class="bg-option">
          <span class="new-badge">New</span>
          <button type="button" class="preset-btn" data-bg="013B84-016EEA" data-color="FFFFFF" data-gradient="true">
            <span class="swatch" style="background: linear-gradient(90deg, #013B84, #016EEA);"></span>
            Waren
          </button>
        </div>
        <div class="bg-option">
          <button type="button" class="preset-btn" data-bg="E7F9FF-90C4E8" data-color="0060A0" data-gradient="true">
            <span class="swatch" style="background: linear-gradient(90deg, #E7F9FF, #90C4E8);"></span>
            OSSPH
          </button>
        </div>
        <div class="bg-option">
          <button type="button" class="preset-btn" data-bg="87CEEB" data-color="1E3A8A">
            <span class="swatch" style="background: #87CEEB;"></span>
            Sky
          </button>
        </div>
        <div class="bg-option">
          <button type="button" class="preset-btn" data-bg="FEE2E2" data-color="BB2C2C">
            <span class="swatch" style="background: #fee2e2;"></span>
            Molty
          </button>
        </div>
        <div class="bg-option">
          <button type="button" class="preset-btn" data-bg="FDE8E3" data-color="DE7356">
            <span class="swatch" style="background: #fde8e3;"></span>
            Claude
          </button>
        </div>
        <div class="bg-option">
          <button type="button" class="preset-btn" data-bg="10A37F" data-color="FFFFFF">
            <span class="swatch" style="background: #10a37f;"></span>
            GPT
          </button>
        </div>
        <div class="bg-option">
          <button type="button" class="preset-btn" data-bg="F3F4F6" data-color="1F2937">
            <span class="swatch" style="background: #f3f4f6;"></span>
            Minimal
          </button>
        </div>
        <div class="bg-option">
          <button type="button" class="preset-btn" data-bg="00000000" data-color="FFFFFF">
            <span class="swatch" style="background: repeating-conic-gradient(#d1d5db 0% 25%, transparent 0% 50%) 50% / 12px 12px; border: 1px solid #30363d;"></span>
            Transparent
          </button>
        </div>
      </div>
        </div>

        </div>

        <div class="content-section">
          <h2>Output</h2>
          <div class="output-container">
            <textarea id="markdown" readonly></textarea>
            <div class="button-row">
              <button id="copy-btn">
                <svg viewBox="0 0 16 16" aria-hidden="true">
                  <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path>
                  <path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
                </svg>
                Copy Markdown
              </button>
              <button id="copy-url-btn" class="secondary">
                <svg viewBox="0 0 16 16" aria-hidden="true">
                  <path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path>
                </svg>
                Copy Image URL
              </button>
              <button id="download-btn" class="secondary">
                <svg viewBox="0 0 16 16" aria-hidden="true">
                  <path d="M2.75 14A1.75 1.75 0 0 1 1 12.25v-2.5a.75.75 0 0 1 1.5 0v2.5c0 .138.112.25.25.25h10.5a.25.25 0 0 0 .25-.25v-2.5a.75.75 0 0 1 1.5 0v2.5A1.75 1.75 0 0 1 13.25 14Z"></path>
                  <path d="M7.25 7.689V2a.75.75 0 0 1 1.5 0v5.689l1.97-1.969a.749.749 0 1 1 1.06 1.06l-3.25 3.25a.749.749 0 0 1-1.06 0L4.22 6.78a.749.749 0 1 1 1.06-1.06l1.97 1.969Z"></path>
                </svg>
                Download SVG
              </button>
              <button id="download-png-btn" class="secondary">
                <svg viewBox="0 0 16 16" aria-hidden="true">
                  <path d="M2.75 14A1.75 1.75 0 0 1 1 12.25v-2.5a.75.75 0 0 1 1.5 0v2.5c0 .138.112.25.25.25h10.5a.25.25 0 0 0 .25-.25v-2.5a.75.75 0 0 1 1.5 0v2.5A1.75 1.75 0 0 1 13.25 14Z"></path>
                  <path d="M7.25 7.689V2a.75.75 0 0 1 1.5 0v5.689l1.97-1.969a.749.749 0 1 1 1.06 1.06l-3.25 3.25a.749.749 0 0 1-1.06 0L4.22 6.78a.749.749 0 1 1 1.06-1.06l1.97 1.969Z"></path>
                </svg>
                Download PNG
              </button>
            </div>
          </div>

          <div class="form-group" style="margin-top: 1.5rem;">
            <label class="checkbox-container">
              <input type="checkbox" id="support" checked />
              <div class="checkbox-label">
                <div class="title">üíñ Help spread the word</div>
                <div class="description">Add a small watermark to help others discover this tool</div>
              </div>
              <span class="toggle-switch"></span>
            </label>
            
            <div class="position-selector" id="position-selector">
              <span class="position-selector-label">Watermark Position</span>
              <div class="position-options">
                <button type="button" class="position-btn active" data-position="bottom-right">Bottom Right</button>
                <button type="button" class="position-btn" data-position="bottom-left">Bottom Left</button>
                <button type="button" class="position-btn" data-position="top-right">Top Right</button>
                <button type="button" class="position-btn" data-position="top-left">Top Left</button>
              </div>
            </div>
          </div>

          <div class="form-group" id="sponsor-link" style="margin-top: 1rem;">
            <div class="sponsor-notice">
              <span id="sponsor-message">Prefer brand-free banners? Consider <a href="https://github.com/sponsors/warengonzaga" target="_blank" rel="noopener">sponsoring</a> instead! üíñ</span>
            </div>
          </div>
        </div>

        </div>
      </div>
    </main>

    <aside class="sidebar">
      <div class="sidebar-section">
        <h2>Author</h2>
        <a href="https://github.com/warengonzaga" target="_blank" rel="noopener" class="author-card">
          <img src="https://github.com/warengonzaga.png" alt="Waren Gonzaga" class="author-avatar">
          <div class="author-info">
            <span class="author-name">Waren Gonzaga</span>
            <span class="author-username">@warengonzaga</span>
          </div>
        </a>
        <a href="https://github.com/sponsors/warengonzaga" target="_blank" rel="noopener" class="sponsor-btn">
          <svg viewBox="0 0 16 16" aria-hidden="true">
            <path d="m8 14.25.345.666a.75.75 0 0 1-.69 0l-.008-.004-.018-.01a7.152 7.152 0 0 1-.31-.17 22.055 22.055 0 0 1-3.434-2.414C2.045 10.731 0 8.35 0 5.5 0 2.836 2.086 1 4.25 1 5.797 1 7.153 1.802 8 3.02 8.847 1.802 10.203 1 11.75 1 13.914 1 16 2.836 16 5.5c0 2.85-2.045 5.231-3.885 6.818a22.066 22.066 0 0 1-3.744 2.584l-.018.01-.006.003h-.002ZM4.25 2.5c-1.336 0-2.75 1.164-2.75 3 0 2.15 1.58 4.144 3.365 5.682A20.58 20.58 0 0 0 8 13.393a20.58 20.58 0 0 0 3.135-2.211C12.92 9.644 14.5 7.65 14.5 5.5c0-1.836-1.414-3-2.75-3-1.373 0-2.609.986-3.029 2.456a.749.749 0 0 1-1.442 0C6.859 3.486 5.623 2.5 4.25 2.5Z"></path>
          </svg>
          Sponsor
        </a>
        <a href="https://x.com/warengonzaga" target="_blank" rel="noopener" class="follow-btn">
          <svg viewBox="0 0 16 16" aria-hidden="true">
            <path d="M9.52 7.77 15.41 1h-1.4l-5.11 5.93L4.55 1H0l6.18 8.98L0 16h1.4l5.4-6.27L11.45 16H16l-6.48-9.43ZM7.57 8.98l-.62-.89L1.98 2.03h2.13l4.01 5.74.62.89 5.2 7.43h-2.13l-4.24-6.07Z"></path>
          </svg>
          Follow @warengonzaga
        </a>
        <p class="author-tagline">The man who wastes his time to save yours! ‚úåÔ∏èüòÑ</p>
      </div>

      <div class="sidebar-section">
        <h2>üîí Privacy Notice</h2>
        <p style="font-size: 0.8125rem; line-height: 1.5; color: #7d8590; margin-bottom: 0.75rem;">
          This service logs button clicks and generated banner URLs via the <code>/log</code> handler (console only) to improve features. When <code>ENABLE_STATS</code> is enabled, the <code>/banner</code> endpoint also stores repository names in Redis for usage statistics‚Äî<strong>not user identities or IPs</strong>. All content is meant to be publicly displayed on GitHub.
        </p>
        <p style="font-size: 0.8125rem; line-height: 1.5; color: #7d8590;">
          We <strong>don't track</strong> IPs, personal info, or user identities. Console logs are ephemeral; Redis stores only repository names for optional stats tracking. 
          <a href="https://github.com/warengonzaga/github-repo-banner#-privacy--transparency" target="_blank" rel="noopener" style="color: #58a6ff;">Learn more</a>
        </p>
      </div>

      <div class="sidebar-section">
        <h2>Contribute</h2>
        <div class="contribute-links">
          <a href="https://github.com/warengonzaga/github-repo-banner/issues/new" target="_blank" rel="noopener" class="contribute-btn">
            <svg viewBox="0 0 16 16" aria-hidden="true">
              <path d="M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path>
              <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Z"></path>
            </svg>
            Report Bug
          </a>
          <a href="https://github.com/warengonzaga/github-repo-banner" target="_blank" rel="noopener" class="contribute-btn">
            <svg viewBox="0 0 16 16" aria-hidden="true">
              <path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.751.751 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25Zm0 2.445L6.615 5.5a.75.75 0 0 1-.564.41l-3.097.45 2.24 2.184a.75.75 0 0 1 .216.664l-.528 3.084 2.769-1.456a.75.75 0 0 1 .698 0l2.77 1.456-.53-3.084a.75.75 0 0 1 .216-.664l2.24-2.183-3.096-.45a.75.75 0 0 1-.564-.41L8 2.694Z"></path>
            </svg>
            Star the Project
          </a>
          <a href="https://github.com/warengonzaga/github-repo-banner/issues/new" target="_blank" rel="noopener" class="contribute-btn">
            <svg viewBox="0 0 16 16" aria-hidden="true">
              <path d="M1.75 1h8.5c.966 0 1.75.784 1.75 1.75v5.5A1.75 1.75 0 0 1 10.25 10H7.061l-2.574 2.573A1.458 1.458 0 0 1 2 11.543V10h-.25A1.75 1.75 0 0 1 0 8.25v-5.5C0 1.784.784 1 1.75 1ZM1.5 2.75v5.5c0 .138.112.25.25.25h1a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h3.5a.25.25 0 0 0 .25-.25v-5.5a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25Zm13 2a.25.25 0 0 0-.25-.25h-.5a.75.75 0 0 1 0-1.5h.5c.966 0 1.75.784 1.75 1.75v5.5A1.75 1.75 0 0 1 14.25 12H14v1.543a1.458 1.458 0 0 1-2.487 1.03L9.22 12.28a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215l2.22 2.22v-2.19a.75.75 0 0 1 .75-.75h1a.25.25 0 0 0 .25-.25Z"></path>
            </svg>
            Feature Request
          </a>
        </div>
        <p class="contribute-message">Any contributions are welcome and I appreciate any help! üôè</p>
      </div>

      <div class="sidebar-section">
        <h2>Self Host</h2>
        <a href="https://railway.com/deploy/github-repo-banner?referralCode=KN9JqT&utm_medium=integration&utm_source=template&utm_campaign=generic" target="_blank" rel="noopener" class="deploy-btn">
          <img src="https://railway.com/button.svg" alt="Deploy on Railway" class="deploy-img">
        </a>
        <p class="deploy-message">When you deploy your own copy, you're directly supporting this project! üíñ</p>
      </div>

      <div class="version-display">v1.2.0</div>
    </aside>
  </div>

  <script>
    const headerInput = document.getElementById('header');
    const subheaderInput = document.getElementById('subheader');
    const previewImg = document.getElementById('preview');
    const markdownInput = document.getElementById('markdown');
    const copyBtn = document.getElementById('copy-btn');
    const copyUrlBtn = document.getElementById('copy-url-btn');
    const downloadBtn = document.getElementById('download-btn');
    const downloadPngBtn = document.getElementById('download-png-btn');
    const bgInput = document.getElementById('bg-input');
    const bgInput2 = document.getElementById('bg-input-2');
    const bgPreview = document.getElementById('bg-preview');
    const bgPreview2 = document.getElementById('bg-preview-2');
    const colorInput = document.getElementById('color-input');
    const colorPreview = document.getElementById('color-preview');
    const subheaderColorInput = document.getElementById('subheader-color-input');
    const subheaderColorPreview = document.getElementById('subheader-color-preview');
    const subheaderColorGroup = document.getElementById('subheader-color-group');
    const headerFontInput = document.getElementById('header-font-input');
    const subheaderFontInput = document.getElementById('subheader-font-input');
    const subheaderFontGroup = document.getElementById('subheader-font-group');
    const supportCheckbox = document.getElementById('support');
    const sponsorLink = document.getElementById('sponsor-link');
    const sponsorMessage = document.getElementById('sponsor-message');
    const sponsorNotice = document.querySelector('.sponsor-notice');
    const presetBtns = document.querySelectorAll('.preset-btn');
    const resetBtn = document.getElementById('reset-btn');
    const positionSelector = document.getElementById('position-selector');
    const positionBtns = document.querySelectorAll('.position-btn');

    let debounceTimer;
    let currentPreset = null;
    let watermarkPosition = 'bottom-right';

    function createEmojiExplosion(emojis, count = 6) {
      const toggleSwitch = document.querySelector('.toggle-switch');
      const rect = toggleSwitch.getBoundingClientRect();
      const centerX = rect.left + rect.width / 2;
      const centerY = rect.top + rect.height / 2;

      for (let i = 0; i < count; i++) {
        const emojiEl = document.createElement('div');
        emojiEl.className = 'emoji-explosion';
        
        // Randomly pick emoji from array
        const randomEmoji = emojis[Math.floor(Math.random() * emojis.length)];
        emojiEl.textContent = randomEmoji;
        
        const angle = (Math.PI * 2 * i) / count + (Math.random() - 0.5) * 0.5;
        const distance = 80 + Math.random() * 120; // Mix of short (80px) and long (200px)
        const tx = Math.cos(angle) * distance;
        const ty = Math.sin(angle) * distance;
        
        // Random duration between 900ms and 1500ms
        const duration = 900 + Math.random() * 600;
        
        emojiEl.style.left = centerX + 'px';
        emojiEl.style.top = centerY + 'px';
        emojiEl.style.setProperty('--tx', tx + 'px');
        emojiEl.style.setProperty('--ty', ty + 'px');
        emojiEl.style.animationDuration = duration + 'ms';
        
        document.body.appendChild(emojiEl);
        
        setTimeout(() => emojiEl.remove(), duration);
      }
    }

    function toggleSponsorLink(animate = true) {
      if (supportCheckbox.checked) {
        // Thank you message
        sponsorNotice.classList.add('thank-you');
        sponsorMessage.innerHTML = 'üôè Thank you for your support! If you\'d like to go further, I\'d be incredibly grateful for any <a href="https://github.com/sponsors/warengonzaga" target="_blank" rel="noopener">sponsorship</a> üíù';
        sponsorLink.style.display = 'block';
        
        // Show position selector
        positionSelector.classList.add('visible');
        
        // Trigger emoji explosion with mix of appreciation emojis
        if (animate) {
          createEmojiExplosion(['üíñ', 'üôè', 'ü´°', 'üëç'], 6);
        }
      } else {
        // Default message
        sponsorNotice.classList.remove('thank-you');
        sponsorMessage.innerHTML = 'üíù Want a clean, brand-free banner? A <a href="https://github.com/sponsors/warengonzaga" target="_blank" rel="noopener">sponsorship</a> would mean the world to me! It keeps this tool free for everyone.';
        sponsorLink.style.display = 'block';
        
        // Hide position selector
        positionSelector.classList.remove('visible');
        
        // Trigger sad emoji explosion - much slower and longer reach
        if (animate) {
          createEmojiExplosionSlow(['üò≠', 'ü´†', 'üòê', 'üòì'], 6);
        }
      }
    }

    function createEmojiExplosionSlow(emojis, count = 6) {
      const toggleSwitch = document.querySelector('.toggle-switch');
      const rect = toggleSwitch.getBoundingClientRect();
      const centerX = rect.left + rect.width / 2;
      const centerY = rect.top + rect.height / 2;

      for (let i = 0; i < count; i++) {
        const emojiEl = document.createElement('div');
        emojiEl.className = 'emoji-explosion';
        
        // Randomly pick emoji from array
        const randomEmoji = emojis[Math.floor(Math.random() * emojis.length)];
        emojiEl.textContent = randomEmoji;
        
        const angle = (Math.PI * 2 * i) / count + (Math.random() - 0.5) * 0.5;
        const distance = 120 + Math.random() * 180; // Even longer reach (120-300px)
        const tx = Math.cos(angle) * distance;
        const ty = Math.sin(angle) * distance;
        
        // Even slower duration between 2500ms and 3800ms
        const duration = 2500 + Math.random() * 1300;
        
        emojiEl.style.left = centerX + 'px';
        emojiEl.style.top = centerY + 'px';
        emojiEl.style.setProperty('--tx', tx + 'px');
        emojiEl.style.setProperty('--ty', ty + 'px');
        emojiEl.style.animation = `explodeSad ${duration}ms ease-out forwards`;
        
        document.body.appendChild(emojiEl);
        
        setTimeout(() => emojiEl.remove(), duration);
      }
    }

    function getBgHex() {
      const val = bgInput.value.trim().replace(/^#/, '');
      if (/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?([0-9a-fA-F]{2})?$/.test(val)) return val;
      return '';
    }

    function getBgHex2() {
      const val = bgInput2.value.trim().replace(/^#/, '');
      if (/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?([0-9a-fA-F]{2})?$/.test(val)) return val;
      return '';
    }

    function getColorHex() {
      const val = colorInput.value.trim().replace(/^#/, '');
      if (/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?([0-9a-fA-F]{2})?$/.test(val)) return val;
      return '';
    }

    function getSubheaderColorHex() {
      const val = subheaderColorInput.value.trim().replace(/^#/, '');
      if (/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?([0-9a-fA-F]{2})?$/.test(val)) return val;
      return '';
    }

    function updateColorPreview() {
      // Background preview
      const bgHex = getBgHex();
      if (bgHex) {
        bgPreview.style.background = '#' + bgHex;
      } else {
        bgPreview.style.background = 'transparent';
      }

      // Background 2 preview
      const bgHex2 = getBgHex2();
      if (bgHex2) {
        bgPreview2.style.background = '#' + bgHex2;
      } else {
        bgPreview2.style.background = 'transparent';
      }

      // Text color preview
      const textHex = getColorHex();
      if (textHex) {
        colorPreview.style.background = '#' + textHex;
      } else {
        colorPreview.style.background = 'transparent';
      }

      // Subheader color preview
      const subHex = getSubheaderColorHex();
      if (subHex) {
        subheaderColorPreview.style.background = '#' + subHex;
      } else {
        subheaderColorPreview.style.background = textHex ? '#' + textHex : 'transparent';
      }
    }

    function clearActivePresets() {
      presetBtns.forEach(btn => btn.classList.remove('active'));
      currentPreset = null;
    }

    function toggleSubheaderFields() {
      const hasSubheader = subheaderInput.value.trim().length > 0;
      subheaderColorGroup.style.display = hasSubheader ? 'block' : 'none';
      subheaderFontGroup.style.display = hasSubheader ? 'block' : 'none';
    }

    function buildUrl() {
      const params = new URLSearchParams();
      const header = headerInput.value || '![github] Hello World üëã';
      params.set('header', header);
      const subheader = subheaderInput.value.trim();
      if (subheader) {
        params.set('subheader', subheader);
      }
      
      // Check if second bg exists to determine gradient or solid
      const bgHex = getBgHex();
      const bgHex2 = getBgHex2();
      
      if (bgHex2) {
        // Gradient: two colors
        params.set('bg', bgHex + '-' + bgHex2);
      } else if (bgHex) {
        // Solid: one color
        params.set('bg', bgHex);
      }
      
      const hex = getColorHex();
      if (hex) {
        params.set('color', hex);
      }
      const subHex = getSubheaderColorHex();
      if (subHex && subheader) {
        params.set('subheadercolor', subHex);
      }
      
      // Add font parameters if specified
      const headerFont = headerFontInput.value.trim();
      if (headerFont) {
        params.set('headerfont', headerFont);
      }
      
      const subheaderFont = subheaderFontInput.value.trim();
      if (subheaderFont && subheader) {
        params.set('subheaderfont', subheaderFont);
      }
      
      if (!supportCheckbox.checked) {
        params.set('support', 'false');
      } else {
        params.set('watermarkpos', watermarkPosition);
      }
      return '/banner?' + params.toString();
    }

    function autoResizeTextarea() {
      // Reset to min-height first to allow proper shrinking
      markdownInput.style.height = '40px';
      // Then set to content height
      markdownInput.style.height = markdownInput.scrollHeight + 'px';
    }

    function update() {
      clearTimeout(debounceTimer);
      debounceTimer = setTimeout(() => {
        const url = buildUrl();
        // Cache-bust for preview, clean URL for markdown
        previewImg.src = url + '&_t=' + Date.now();
        const fullUrl = window.location.origin + url;
        let markdown = '![GitHub Repo Banner](' + fullUrl + ')';
        
        // Add attribution as a new line when support is enabled
        if (supportCheckbox.checked) {
          markdown += '\n<!-- Created with GitHub Repo Banner by Waren Gonzaga: https://ghrb.waren.build -->';
        }
        
        markdownInput.value = markdown;
        autoResizeTextarea();
      }, 300);
    }

    // Character counting and validation functions
    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    function removeEmojis(text) {
      // Remove emojis using regex (matches all emoji characters)
      return text.replace(/[\u{1F300}-\u{1F9FF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}\u{1F000}-\u{1F02F}\u{1F0A0}-\u{1F0FF}\u{1F100}-\u{1F64F}\u{1F680}-\u{1F6FF}\u{1F900}-\u{1F9FF}\u{1FA00}-\u{1FA6F}\u{1FA70}-\u{1FAFF}\u{FE00}-\u{FE0F}\u{200D}\u{20E3}\u{E0020}-\u{E007F}]/gu, '');
    }

    function extractIcons(text) {
      // Match ![icon-name] or ![icon-name](theme)
      const iconRegex = /!\[([^\]]+)\](?:\([^)]+\))?/g;
      const icons = [];
      let match;
      while ((match = iconRegex.exec(text)) !== null) {
        icons.push({
          fullMatch: match[0],
          name: match[1]
        });
      }
      return icons;
    }

    function getTextWithoutIconsAndEmojis(text) {
      // Remove icon syntax first
      const textWithoutIcons = text.replace(/!\[[^\]]+\](?:\([^)]+\))?/g, '');
      // Then remove emojis
      return removeEmojis(textWithoutIcons);
    }

    // Simulate backend sanitizeHeader truncation logic
    function simulateTruncation(text, maxLength) {
      if (text.length <= maxLength) {
        return text;
      }
      
      let truncated = text.slice(0, maxLength);
      
      // Check if we're in the middle of an icon syntax ![...]
      const lastOpenBracket = truncated.lastIndexOf('![');
      
      if (lastOpenBracket !== -1) {
        const afterOpen = truncated.slice(lastOpenBracket);
        const hasClosing = afterOpen.includes(']');
        
        // If no closing bracket, we cut in the middle of an icon - remove it
        if (!hasClosing) {
          truncated = truncated.slice(0, lastOpenBracket);
        }
      }
      
      return truncated.trimEnd();
    }

    function validateInput(input, textLimit, iconLimit) {
      const value = input.value;
      const icons = extractIcons(value);
      const textOnly = getTextWithoutIconsAndEmojis(value);
      
      // Calculate limits
      const textLength = textOnly.length;
      const maxIconLength = Math.max(...icons.map(i => i.name.length), 0);
      
      const textExceeded = textLength > textLimit;
      const iconExceeded = maxIconLength > iconLimit;
      
      // Check if content will be truncated by backend
      const truncated = simulateTruncation(value, textLimit);
      const willBeTruncated = truncated.length < value.length;
      
      return {
        textLength,
        textLimit,
        textExceeded,
        icons,
        maxIconLength,
        iconLimit,
        iconExceeded,
        willBeTruncated,
        anyExceeded: textExceeded || iconExceeded
      };
    }

    function updateCharCounter(input, counterEl, textCountEl, iconCountEl, textLimit, iconLimit) {
      const validation = validateInput(input, textLimit, iconLimit);
      
      // Update text counter
      textCountEl.textContent = `Text: ${validation.textLength}/${validation.textLimit}`;
      textCountEl.classList.toggle('exceeded', validation.textExceeded);
      textCountEl.classList.toggle('warning', !validation.textExceeded && validation.textLength > textLimit * 0.9);
      
      // Update icon counter with individual icon character counts
      if (validation.icons.length > 0) {
        // Compact display with tooltip for details
        const iconCount = validation.icons.length;
        const iconDetails = validation.icons.map(i => `![${escapeHtml(i.name)}] (${i.name.length} chars)`).join('\n');

        iconCountEl.innerHTML = `Icons: ${iconCount} <span class="char-counter-info"><span class="char-counter-info-icon" title="Click for details">i</span><span class="char-counter-tooltip">${escapeHtml(iconDetails)}</span></span> | Max: ${validation.maxIconLength}/${validation.iconLimit}`;
        iconCountEl.classList.toggle('exceeded', validation.iconExceeded);
        iconCountEl.classList.toggle('warning', !validation.iconExceeded && validation.maxIconLength > iconLimit * 0.9);
      } else {
        iconCountEl.textContent = `Icons: none`;
        iconCountEl.classList.remove('exceeded', 'warning');
      }
      
      // Add click handler for info icon to toggle tooltip
      const infoIcon = iconCountEl.querySelector('.char-counter-info-icon');
      if (infoIcon) {
        infoIcon.onclick = (e) => {
          e.stopPropagation();
          infoIcon.classList.toggle('active');
          // Remove active class when clicking outside
          setTimeout(() => {
            const closeOnClick = (evt) => {
              if (!infoIcon.contains(evt.target)) {
                infoIcon.classList.remove('active');
                document.removeEventListener('click', closeOnClick);
              }
            };
            document.addEventListener('click', closeOnClick);
          }, 0);
        };
      }
      
      // Show truncation warning if needed
      let truncationWarning = counterEl.querySelector('.truncation-warning');
      if (validation.willBeTruncated) {
        if (!truncationWarning) {
          const separator = document.createElement('span');
          separator.className = 'char-counter-separator';
          separator.textContent = '|';
          truncationWarning = document.createElement('span');
          truncationWarning.className = 'char-counter-part truncated truncation-warning';
          counterEl.appendChild(separator);
          counterEl.appendChild(truncationWarning);
        }
        truncationWarning.textContent = '‚ö†Ô∏è Content will be truncated';
      } else if (truncationWarning) {
        const separator = truncationWarning.previousSibling;
        if (separator && separator.classList && separator.classList.contains('char-counter-separator')) {
          separator.remove();
        }
        truncationWarning.remove();
      }
      
      // Update input border
      input.classList.toggle('limit-exceeded', validation.anyExceeded);
      input.classList.toggle('will-truncate', !validation.anyExceeded && validation.willBeTruncated);
    }

    headerInput.addEventListener('input', () => {
      updateCharCounter(headerInput, document.getElementById('header-counter'), 
        document.getElementById('header-text-count'), 
        document.getElementById('header-icon-count'), 50, 50);
      update();
    });
    
    subheaderInput.addEventListener('input', () => {
      updateCharCounter(subheaderInput, document.getElementById('subheader-counter'),
        document.getElementById('subheader-text-count'),
        document.getElementById('subheader-icon-count'), 60, 50);
      toggleSubheaderFields();
      update();
    });
    headerFontInput.addEventListener('input', update);
    subheaderFontInput.addEventListener('input', update);

    // Color picker functionality
    const bgPicker = document.getElementById('bg-picker');
    const bgPicker2 = document.getElementById('bg-picker-2');
    const colorPicker = document.getElementById('color-picker');
    const subheaderColorPicker = document.getElementById('subheader-color-picker');

    // Function to setup color picker
    function setupColorPicker(previewEl, pickerEl, inputEl) {
      // Click preview to open picker
      previewEl.addEventListener('click', () => {
        pickerEl.click();
      });

      // When picker changes, update hex input
      pickerEl.addEventListener('input', (e) => {
        const hex = e.target.value.substring(1).toUpperCase();
        inputEl.value = hex;
        updateColorPreview();
        update();
      });

      // When hex input changes, update picker
      inputEl.addEventListener('input', () => {
        const hex = inputEl.value.replace(/^#/, '');
        if (/^[0-9A-Fa-f]{6}$/.test(hex)) {
          pickerEl.value = '#' + hex;
        }
      });
    }

    // Setup all color pickers
    setupColorPicker(bgPreview, bgPicker, bgInput);
    setupColorPicker(bgPreview2, bgPicker2, bgInput2);
    setupColorPicker(colorPreview, colorPicker, colorInput);
    setupColorPicker(subheaderColorPreview, subheaderColorPicker, subheaderColorInput);

    // Preset buttons populate input fields
    presetBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        const bgValue = btn.dataset.bg;
        const colorValue = btn.dataset.color;
        const isGradient = btn.dataset.gradient === 'true';
        
        // Fade out "New" badge if present
        const bgOption = btn.closest('.bg-option');
        if (bgOption) {
          const badge = bgOption.querySelector('.new-badge');
          if (badge && !badge.classList.contains('fade-out')) {
            badge.classList.add('fade-out');
          }
        }
        
        // Update active state
        clearActivePresets();
        btn.classList.add('active');
        
        // Store current preset info
        currentPreset = {
          bg: bgValue,
          gradient: isGradient
        };
        
        // Populate input fields based on preset type
        if (isGradient) {
          // For gradients, populate both bg fields
          const [startHex, endHex] = bgValue.split('-');
          bgInput.value = startHex;
          bgInput2.value = endHex;
          colorInput.value = colorValue;
        } else {
          // For solid colors (including transparent)
          bgInput.value = bgValue;
          bgInput2.value = ''; // Clear second bg for solid
          colorInput.value = colorValue;
        }
        
        updateColorPreview();
        update();
      });
    });

    // Helper function to normalize hex input (strip # prefix)
    function normalizeHexInput(input) {
      let val = input.value.trim();
      if (val.startsWith('#')) {
        input.value = val.substring(1);
      }
    }

    // When user manually edits, clear preset selection
    bgInput.addEventListener('input', () => {
      normalizeHexInput(bgInput);
      clearActivePresets();
      currentPreset = null;
      updateColorPreview();
      update();
    });

    bgInput2.addEventListener('input', () => {
      normalizeHexInput(bgInput2);
      clearActivePresets();
      currentPreset = null;
      updateColorPreview();
      update();
    });

    colorInput.addEventListener('input', () => {
      normalizeHexInput(colorInput);
      updateColorPreview();
      update();
    });
    
    subheaderColorInput.addEventListener('input', () => {
      normalizeHexInput(subheaderColorInput);
      updateColorPreview();
      update();
    });

    supportCheckbox.addEventListener('change', () => {
      toggleSponsorLink();
      update();
    });

    // Position selector buttons
    positionBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        // Remove active class from all position buttons
        positionBtns.forEach(b => b.classList.remove('active'));
        // Add active class to clicked button
        btn.classList.add('active');
        // Update watermark position
        watermarkPosition = btn.dataset.position;
        // Update preview
        update();
      });
    });

    resetBtn.addEventListener('click', () => {
      // Reset all form fields to defaults
      headerInput.value = '![github] Hello World üëã';
      subheaderInput.value = 'Great projects deserve great repository banners';
      headerFontInput.value = 'Permanent Marker';
      subheaderFontInput.value = 'Kinewave';
      bgInput.value = '1A1A1A';
      bgInput2.value = '4A4A4A';
      colorInput.value = 'FFFFFF';
      subheaderColorInput.value = '';
      supportCheckbox.checked = true;
      
      // Reset watermark position
      watermarkPosition = 'bottom-right';
      positionBtns.forEach(btn => {
        if (btn.dataset.position === 'bottom-right') {
          btn.classList.add('active');
        } else {
          btn.classList.remove('active');
        }
      });
      
      // Reset to Midnight preset
      clearActivePresets();
      const defaultPreset = document.querySelector('.preset-btn[data-bg="1A1A1A-4A4A4A"]');
      if (defaultPreset) {
        defaultPreset.classList.add('active');
        currentPreset = {
          bg: '1A1A1A-4A4A4A',
          gradient: true
        };
      }
      
      // Reset sponsor link
      toggleSponsorLink(false);
      
      // Update UI
      toggleSubheaderFields();
      updateColorPreview();
      update();
    });

    copyBtn.addEventListener('click', () => {
      const url = buildUrl();
      
      // Log action to server
      fetch('/log', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ action: 'Copy Markdown', url })
      }).catch(() => {}); // Silent fail
      
      navigator.clipboard.writeText(markdownInput.value).then(() => {
        copyBtn.textContent = 'Copied!';
        copyBtn.classList.add('copied');
        setTimeout(() => {
          copyBtn.textContent = 'Copy Markdown';
          copyBtn.classList.remove('copied');
        }, 2000);
      });
    });

    copyUrlBtn.addEventListener('click', () => {
      // Build URL without support parameter
      const params = new URLSearchParams();
      const header = headerInput.value || '![github] Hello World üëã';
      params.set('header', header);
      const subheader = subheaderInput.value.trim();
      if (subheader) {
        params.set('subheader', subheader);
      }
      
      // Use preset bg if active (gradient or transparent), otherwise custom hex
      if (currentPreset) {
        params.set('bg', currentPreset.bg);
      } else {
        // Custom background color
        const bgHex = getBgHex();
        if (bgHex) {
          params.set('bg', bgHex);
        }
      }
      
      const hex = getColorHex();
      if (hex) {
        params.set('color', hex);
      }
      const subHex = getSubheaderColorHex();
      if (subHex && subheader) {
        params.set('subheadercolor', subHex);
      }
      // Note: We intentionally do NOT include the support parameter here
      
      const imageUrl = window.location.origin + '/banner?' + params.toString();
      
      // Log action to server
      fetch('/log', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ action: 'Copy Image URL', url: '/banner?' + params.toString() })
      }).catch(() => {}); // Silent fail
      
      navigator.clipboard.writeText(imageUrl).then(() => {
        copyUrlBtn.textContent = 'Copied!';
        copyUrlBtn.classList.add('copied');
        setTimeout(() => {
          copyUrlBtn.textContent = 'Copy Image URL';
          copyUrlBtn.classList.remove('copied');
        }, 2000);
      });
    });

    downloadBtn.addEventListener('click', async () => {
      try {
        const url = buildUrl();
        
        // Log action to server
        fetch('/log', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ action: 'Download SVG', url })
        }).catch(() => {}); // Silent fail
        
        const response = await fetch(url);
        const svgBlob = await response.blob();
        const downloadUrl = URL.createObjectURL(svgBlob);
        
        const a = document.createElement('a');
        a.href = downloadUrl;
        a.download = `banner-${headerInput.value.replace(/[^a-z0-9]/gi, '-').toLowerCase()}.svg`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(downloadUrl);
        
        downloadBtn.textContent = 'Downloaded!';
        downloadBtn.classList.add('copied');
        setTimeout(() => {
          downloadBtn.textContent = 'Download SVG';
          downloadBtn.classList.remove('copied');
        }, 2000);
      } catch (error) {
        console.error('Download failed:', error);
      }
    });

    downloadPngBtn.addEventListener('click', async () => {
      try {
        const url = buildUrl();
        
        // Log action to server
        fetch('/log', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ action: 'Download PNG', url })
        }).catch(() => {}); // Silent fail
        
        const response = await fetch(url);
        const svgText = await response.text();
        
        // Encode SVG as data URL
        const svgDataUrl = 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent(svgText);
        
        // Create an image element to load the SVG
        const img = new Image();
        img.onload = () => {
          // Create canvas with same dimensions as banner (1280x304)
          const canvas = document.createElement('canvas');
          canvas.width = 1280;
          canvas.height = 304;
          const ctx = canvas.getContext('2d');
          
          if (!ctx) {
            console.error('Failed to get 2D context from canvas');
            downloadPngBtn.textContent = 'Download failed';
            setTimeout(() => {
              downloadPngBtn.textContent = 'Download PNG';
            }, 2000);
            return;
          }
          
          // Draw the image onto canvas
          ctx.drawImage(img, 0, 0);
          
          // Convert canvas to blob and download
          canvas.toBlob((blob) => {
            if (!blob) {
              console.error('Failed to convert canvas to PNG blob');
              downloadPngBtn.textContent = 'Download failed';
              setTimeout(() => {
                downloadPngBtn.textContent = 'Download PNG';
              }, 2000);
              return;
            }
            
            const downloadUrl = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = downloadUrl;
            
            // Generate safe filename from header, with fallback
            const headerText = headerInput.value.trim() || 'banner';
            const safeFilename = headerText.replace(/[^a-z0-9]/gi, '-').toLowerCase().replace(/-+/g, '-').replace(/^-+|-+$/g, '');
            a.download = `banner-${safeFilename || 'download'}.png`;
            
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(downloadUrl);
            
            downloadPngBtn.textContent = 'Downloaded!';
            downloadPngBtn.classList.add('copied');
            setTimeout(() => {
              downloadPngBtn.textContent = 'Download PNG';
              downloadPngBtn.classList.remove('copied');
            }, 2000);
          }, 'image/png');
        };
        
        img.onerror = (e) => {
          console.error('Failed to load SVG image for conversion. URL:', url, 'Error:', e);
          downloadPngBtn.textContent = 'Download failed';
          setTimeout(() => {
            downloadPngBtn.textContent = 'Download PNG';
          }, 2000);
        };
        
        img.src = svgDataUrl;
      } catch (error) {
        console.error('PNG download failed:', error);
        downloadPngBtn.textContent = 'Download failed';
        setTimeout(() => {
          downloadPngBtn.textContent = 'Download PNG';
        }, 2000);
      }
    });

    // Initial render (no debounce)
    (function() {
      // Set default Midnight preset as active
      const defaultPreset = document.querySelector('.preset-btn[data-bg="1A1A1A-4A4A4A"]');
      if (defaultPreset) {
        defaultPreset.classList.add('active');
        currentPreset = {
          bg: '1A1A1A-4A4A4A',
          gradient: true
        };
      }
      
      toggleSponsorLink(false); // Don't animate on initial load
      toggleSubheaderFields();
      updateColorPreview();
      
      // Initialize character counters
      updateCharCounter(headerInput, document.getElementById('header-counter'),
        document.getElementById('header-text-count'),
        document.getElementById('header-icon-count'), 50, 50);
      updateCharCounter(subheaderInput, document.getElementById('subheader-counter'),
        document.getElementById('subheader-text-count'),
        document.getElementById('subheader-icon-count'), 60, 50);
      
      const url = buildUrl();
      previewImg.src = url + '&_t=' + Date.now();
      const fullUrl = window.location.origin + url;
      let markdown = '![GitHub Repo Banner](' + fullUrl + ')';
      if (supportCheckbox.checked) {
        markdown += '\n<!-- Created with GitHub Repo Banner by Waren Gonzaga: https://ghrb.waren.build -->';
      }
      markdownInput.value = markdown;
      autoResizeTextarea();
    })();

    // Info tooltip functionality
    const headerInfoBtn = document.getElementById('header-info-btn');
    const headerInfoTooltip = document.getElementById('header-info-tooltip');
    const subheaderInfoBtn = document.getElementById('subheader-info-btn');
    const subheaderInfoTooltip = document.getElementById('subheader-info-tooltip');
    const headerFontInfoBtn = document.getElementById('header-font-info-btn');
    const headerFontInfoTooltip = document.getElementById('header-font-info-tooltip');
    const subheaderFontInfoBtn = document.getElementById('subheader-font-info-btn');
    const subheaderFontInfoTooltip = document.getElementById('subheader-font-info-tooltip');

    function toggleTooltip(tooltip) {
      // Close other tooltips
      document.querySelectorAll('.info-tooltip').forEach(t => {
        if (t !== tooltip) {
          t.classList.remove('show');
        }
      });
      tooltip.classList.toggle('show');
    }

    headerInfoBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      toggleTooltip(headerInfoTooltip);
    });

    subheaderInfoBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      toggleTooltip(subheaderInfoTooltip);
    });

    headerFontInfoBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      toggleTooltip(headerFontInfoTooltip);
    });

    subheaderFontInfoBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      toggleTooltip(subheaderFontInfoTooltip);
    });

    // Close tooltips when clicking outside
    document.addEventListener('click', (e) => {
      if (!e.target.closest('.input-with-info')) {
        document.querySelectorAll('.info-tooltip').forEach(t => {
          t.classList.remove('show');
        });
      }
    });
  </script>
</body>
</html>
